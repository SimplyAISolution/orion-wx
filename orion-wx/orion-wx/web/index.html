<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Orion WX â€” Map</title>
    <link
      href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css"
      rel="stylesheet"
    />
    <style>
      html, body, #map { height: 100%; margin: 0; }
      .panel { position: absolute; top: 10px; left: 10px; background: #fff; padding: 10px; border-radius: 8px; }
      label { display:block; margin: 6px 0; }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <div class="panel">
      <label>Lat <input id="lat" value="40.0" size="6"></label>
      <label>Lon <input id="lon" value="-105.0" size="6"></label>
      <label>Lead (h) <input id="lead" value="24" size="4"></label>
      <button id="fetchBtn">Get forecast</button>
      <pre id="out" style="font-size:12px"></pre>
    </div>
    <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
    <script>
      const map = new maplibregl.Map({
        container: 'map',
        style: 'https://demotiles.maplibre.org/style.json',
        center: [-105, 40],
        zoom: 5
      });
      document.getElementById('fetchBtn').onclick = async () => {
        const lat = parseFloat(document.getElementById('lat').value);
        const lon = parseFloat(document.getElementById('lon').value);
        const lead = parseInt(document.getElementById('lead').value);
        const r = await fetch('/forecast', {
          method: 'POST', headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({lat, lon, lead_hours: lead, variable: 'precip'})
        });
        document.getElementById('out').textContent = JSON.stringify(await r.json(), null, 2);
      };
    </script>
  </body>
</html>
